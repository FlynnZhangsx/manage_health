
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·APP UI/UX è®¾è®¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  function switchModule(module) {
    // éšè—æ‰€æœ‰æ¨¡å—
    const modules = document.querySelectorAll('.main-module');
    modules.forEach(m => m.classList.add('hidden'));
    
    // æ˜¾ç¤ºé€‰ä¸­çš„æ¨¡å—
    const targetModule = document.getElementById(module + 'Module');
    if (targetModule) {
        targetModule.classList.remove('hidden');
    }

    // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
    const navButtons = document.querySelectorAll('nav.w-1/5 button');
    navButtons.forEach(btn => {
        btn.classList.remove('text-blue-500', 'text-indigo-500', 'text-pink-500', 'text-emerald-500', 'bg-blue-50', 'bg-indigo-50', 'bg-pink-50', 'bg-emerald-50');
        btn.classList.add('text-gray-400');
    });
    
    // è®¾ç½®å½“å‰é€‰ä¸­æŒ‰é’®çš„é¢œè‰²
    const activeBtn = document.querySelector(`nav.w-1/5 button[onclick*="${module}"]`);
    if (activeBtn) {
        switch(module) {
            case 'exercise':
                activeBtn.classList.add('text-blue-500', 'bg-blue-50');
                break;
            case 'sleep':
                activeBtn.classList.add('text-indigo-500', 'bg-indigo-50');
                break;
            case 'period':
                activeBtn.classList.add('text-pink-500', 'bg-pink-50');
                break;
            case 'profile':
                activeBtn.classList.add('text-emerald-500', 'bg-emerald-50');
                break;
        }
    }
    
    // æ»šåŠ¨åˆ°é¡¶éƒ¨
    window.scrollTo(0, 0);
  }
  document.addEventListener('DOMContentLoaded', () => switchModule('exercise'));

  function openSleepModal() {
    document.getElementById('sleepModal').classList.remove('hidden');
}

function closeSleepModal() {
    document.getElementById('sleepModal').classList.add('hidden');
}

function handleSleepSubmit(event) {
    event.preventDefault();
    
    const sleepTime = document.getElementById('sleepTimeInput').value;
    const wakeTime = document.getElementById('wakeTimeInput').value;
    const quality = document.getElementById('qualitySelect').value;
    
    if (!sleepTime || !wakeTime) {
        alert('è¯·å¡«å†™å…¥ç¡å’Œèµ·åºŠæ—¶é—´');
        return;
    }
    
    const sleepData = {
        sleepTime,
        wakeTime,
        quality,
        date: new Date().toISOString().split('T')[0]
    };
    
    saveSleepData(sleepData);
    alert('ç¡çœ è®°å½•å·²ä¿å­˜');
    closeSleepModal();
}

function openGoalModal() {
    document.getElementById('goalModal').classList.remove('hidden');
  }

  function closeGoalModal() {
    document.getElementById('goalModal').classList.add('hidden');
  }

  function saveGoal() {
    const goal = document.querySelector('#goalModal input[type="number"]').value;
    alert(`å·²è®¾ç½®ç›®æ ‡æ­¥æ•°ä¸ºï¼š${goal}`);
    closeGoalModal();
  }
  
  // æ·»åŠ å¼ºåº¦è¯´æ˜å¼¹çª—æ§åˆ¶å‡½æ•°
  function openIntensityModal() {
    document.getElementById('intensityModal').classList.remove('hidden');
  }

  function closeIntensityModal() {
    document.getElementById('intensityModal').classList.add('hidden');
  }
  
  // æ·»åŠ ç¡çœ è¯¦ç»†æŠ¥å‘Šå¼¹çª—æ§åˆ¶å‡½æ•°
  function openSleepDetailModal() {
    document.getElementById('sleepDetailModal').classList.remove('hidden');
  }

  function closeSleepDetailModal() {
    document.getElementById('sleepDetailModal').classList.add('hidden');
  }
</script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
<!-- é¡¶éƒ¨å¯¼èˆªæ  -->
<nav class="fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-md border-b border-gray-200">
  <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-14">
      <!-- å±…ä¸­ï¼šåº”ç”¨Logo -->
      <div class="flex items-center justify-center w-full">
        <img src="https://placehold.co/40x40" alt="Logo" class="h-8 w-8 rounded-full">
        <span class="ml-2 text-xl font-semibold text-gray-800">å¥åº·åŠ©æ‰‹</span>
      </div>

      <!-- å³ä¾§ï¼šå¯¼èˆªèœå• -->
      <div class="flex items-center space-x-4">
        <!-- ç”¨æˆ·å¤´åƒ -->
        <div class="relative group">
          <img src="https://placehold.co/40x40" alt="User Avatar" class="h-8 w-8 rounded-full cursor-pointer hover:ring-2 hover:ring-blue-500">
          <!-- ç”¨æˆ·èœå• -->
          <div class="hidden group-hover:block absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
            <div class="py-1">
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">ä¸ªäººèµ„æ–™</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">è®¾ç½®</a>
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">ç™»å‡º</a>
            </div>
          </div>
        </div>

        <!-- é€šçŸ¥å›¾æ ‡ -->
        <div class="relative">
          <button class="p-1 text-gray-500 hover:text-gray-700 focus:outline-none">
            <i class="fas fa-bell text-xl"></i>
            <span class="absolute top-0 right-0 inline-block w-2 h-2 bg-red-500 rounded-full"></span>
          </button>
        </div>

        <!-- è®¾ç½®å›¾æ ‡ -->
        <button class="p-1 text-gray-500 hover:text-gray-700 focus:outline-none">
          <i class="fas fa-cog text-xl"></i>
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- ä¸»ä½“å†…å®¹åŒº - ä½¿ç”¨Flexboxå¸ƒå±€ -->
<div class="flex w-full min-h-screen pt-14">
  <!-- å·¦ä¾§å¯¼èˆªæ  -->
  <nav class="w-1/5 bg-white border-r border-gray-200 shadow-md fixed left-0 top-14 bottom-0 overflow-y-auto">
    <div class="flex flex-col h-full p-4 space-y-8">
      <!-- App Logo å’Œåº”ç”¨åç§° -->
      <div class="flex flex-col items-center justify-center py-4">
        <img src="https://placehold.co/60x60" alt="Logo" class="h-16 w-16 rounded-full mb-2">
        <span class="text-lg font-semibold text-gray-800">å¥åº·åŠ©æ‰‹</span>
      </div>
      
      <!-- å¯¼èˆªèœå• -->
      <div class="flex flex-col space-y-4">
        <button class="flex items-center p-3 rounded-xl text-gray-400 hover:bg-blue-50 hover:text-blue-500 transition-colors" onclick="switchModule('exercise')">
          <i class="fas fa-running text-xl w-8"></i>
          <span class="text-sm ml-2">è¿åŠ¨è®°å½•</span>
        </button>
        <button class="flex items-center p-3 rounded-xl text-gray-400 hover:bg-indigo-50 hover:text-indigo-500 transition-colors" onclick="switchModule('sleep')">
          <i class="fas fa-moon text-xl w-8"></i>
          <span class="text-sm ml-2">ç¡çœ åˆ†æ</span>
        </button>
        <button class="flex items-center p-3 rounded-xl text-gray-400 hover:bg-pink-50 hover:text-pink-500 transition-colors" onclick="switchModule('period')">
          <i class="fas fa-calendar-alt text-xl w-8"></i>
          <span class="text-sm ml-2">ç»æœŸè®°å½•</span>
        </button>
        <button class="flex items-center p-3 rounded-xl text-gray-400 hover:bg-emerald-50 hover:text-emerald-500 transition-colors" onclick="switchModule('profile')">
          <i class="fas fa-user text-xl w-8"></i>
          <span class="text-sm ml-2">ä¸ªäººä¸»é¡µ</span>
        </button>
      </div>
      
      <!-- åº•éƒ¨é“¾æ¥ -->
      <div class="mt-auto flex flex-col space-y-2 pt-8">
        <button class="flex items-center p-3 rounded-xl text-gray-400 hover:bg-gray-100 transition-colors">
          <i class="fas fa-cog text-xl w-8"></i>
          <span class="text-sm ml-2">è®¾ç½®</span>
        </button>
        <button class="flex items-center p-3 rounded-xl text-gray-400 hover:bg-gray-100 transition-colors">
          <i class="fas fa-question-circle text-xl w-8"></i>
          <span class="text-sm ml-2">å¸®åŠ©ä¸­å¿ƒ</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- å³ä¾§å†…å®¹åŒº -->
  <div class="w-4/5 ml-[20%] overflow-y-auto">
    <!-- è®¾è®¡é¢„è§ˆåŒºåŸŸ -->
    <div class="p-6">
    
 <!-- è¿åŠ¨è®°å½•ä¸»é¡µé¢ -->
<div id="exerciseModule" class="main-module w-full min-h-[calc(100vh-3.5rem)] bg-white rounded-3xl shadow-lg p-6 md:p-8 lg:p-10 relative overflow-hidden">
    <!-- å¤´éƒ¨åŒºåŸŸ -->
    <div class="flex justify-between items-center mb-6">
        <div>
            <h2 class="text-2xl font-bold text-gray-800">ä»Šæ—¥è¿åŠ¨</h2>
            <p class="text-gray-500 text-sm">2024å¹´3æœˆ21æ—¥</p>
        </div>
        <button onclick="openExerciseModal()" class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-blue-600 transition-colors">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- æ ¸å¿ƒæ•°æ®åŒº -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- ä¸»è¦æŒ‡æ ‡å¡ç‰‡ -->
        <div class="lg:col-span-2 bg-blue-50 rounded-2xl p-6">
            <div class="grid grid-cols-3 gap-4">
                <div class="text-center">
                    <div class="text-4xl font-bold text-blue-600 mb-2">8,547</div>
                    <div class="text-sm text-gray-600">ä»Šæ—¥æ­¥æ•°</div>
                    <div class="mt-3 h-1 bg-blue-200 rounded-full">
                        <div class="w-3/4 h-full bg-blue-500 rounded-full"></div>
                    </div>
                </div>
                <div class="text-center border-x border-blue-100">
                    <div class="text-4xl font-bold text-blue-600 mb-2">6.4</div>
                    <div class="text-sm text-gray-600">å…¬é‡Œ</div>
                    <div class="mt-3 flex justify-center items-center gap-1">
                        <i class="fas fa-shoe-prints text-blue-400"></i>
                        <span class="text-xs text-blue-600">å¹³å‡æ­¥é¢‘ 112æ­¥/åˆ†é’Ÿ</span>
                    </div>
                </div>
                <div class="text-center">
                    <div class="text-4xl font-bold text-blue-600 mb-2">427</div>
                    <div class="text-sm text-gray-600">å¡è·¯é‡Œ</div>
                    <div class="mt-3 text-xs text-blue-500">
                        â‰ˆ {ç‡ƒçƒ§è„‚è‚ªæ—¶é•¿ 45åˆ†é’Ÿ}
                    </div>
                </div>
            </div>
        </div>

        <!-- è¿åŠ¨å¼ºåº¦å¡ç‰‡ -->
        <div class="bg-white rounded-2xl p-6 border border-blue-100">
            <div class="flex flex-col h-full justify-between">
                <div class="text-center">
                    <div class="text-xl font-semibold text-blue-600">ä¸­ç­‰å¼ºåº¦è¿åŠ¨</div>
                    <div class="text-sm text-gray-500 mt-1">å½“å‰è¿åŠ¨å¼ºåº¦</div>
                </div>
                <div class="mt-4 relative">
                    <div class="h-2 bg-blue-200 rounded-full">
                        <div class="w-2/3 h-full bg-blue-500 rounded-full"></div>
                    </div>
                    <div class="flex justify-between text-xs text-blue-600 mt-2">
                        <span>ä½</span>
                        <span>ä¸­</span>
                        <span>é«˜</span>
                    </div>
                </div>
                <button class="mt-4 text-blue-500 hover:text-blue-600 text-sm flex items-center justify-center gap-1" onclick="openIntensityModal()">
                    <i class="fas fa-info-circle"></i>
                    <span>å¼ºåº¦è¯´æ˜</span>
                </button>
            </div>
        </div>
    </div>

        <!-- å‘¨æ•°æ®æŸ±çŠ¶å›¾ -->
        <div class="grid grid-cols-2 gap-4 mt-6">
            <div class="rounded-2xl p-4">
                <div class="flex justify-between items-center mb-4"><h3 class="text-gray-700 font-semibold">è¿åŠ¨è¶‹åŠ¿</h3><div class="flex space-x-2"><button class="text-sm text-gray-500 hover:text-blue-500 px-2 py-1 rounded-lg" onclick="switchChartView('week')">æœ¬å‘¨</button><button class="text-sm text-gray-500 hover:text-blue-500 px-2 py-1 rounded-lg" onclick="switchChartView('month')">æœ¬æœˆ</button><button class="text-sm text-gray-500 hover:text-blue-500 px-2 py-1 rounded-lg" onclick="switchChartView('year')">å¹´åº¦</button></div></div>
                <div class="flex justify-between items-end h-32">
                    <div class="flex flex-col items-center">
                        <div class="h-20 w-8 bg-blue-200 rounded-t-lg"></div>
                        <span class="text-xs text-gray-500 mt-2">ä¸€</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="h-24 w-8 bg-blue-300 rounded-t-lg"></div>
                        <span class="text-xs text-gray-500 mt-2">äºŒ</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="h-16 w-8 bg-blue-200 rounded-t-lg"></div>
                        <span class="text-xs text-gray-500 mt-2">ä¸‰</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="h-28 w-8 bg-blue-500 rounded-t-lg"></div>
                        <span class="text-xs text-gray-500 mt-2">å››</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="h-12 w-8 bg-blue-200 rounded-t-lg"></div>
                        <span class="text-xs text-gray-500 mt-2">äº”</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="h-20 w-8 bg-blue-200 rounded-t-lg"></div>
                        <span class="text-xs text-gray-500 mt-2">å…­</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="h-16 w-8 bg-blue-200 rounded-t-lg"></div>
                        <span class="text-xs text-gray-500 mt-2">æ—¥</span>
                    </div>
                </div>
            </div>
            <div class="rounded-2xl p-4">
                <h3 class="text-xl font-bold text-blue-600 mb-4">ä»Šæ—¥æ­¥æ•°ç›®æ ‡</h3>
                <div class="space-y-4">
                    <div class="text-center">
                        <div class="text-4xl font-bold text-blue-600 mb-2 bg-blue-100 p-4 rounded-lg">10,000</div>
                        <div class="text-sm text-gray-500 text-center">å·²å®Œæˆ 85%</div>
                        <button onclick="openGoalModal()" class="w-full py-2 rounded-xl bg-grey-100 text-blue-600 font-medium hover:bg-blue-200 text-sm">
                            ä¿®æ”¹ç›®æ ‡
                        </button>
                    </div>
                </div>
            </div>
        </div>

       
    </div>

    <!-- æ•°æ®å½•å…¥å¼¹çª— -->
    <div id="exerciseModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-full max-w-[500px] h-[500px] bg-white rounded-2xl p-4 shadow-lg overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-gray-800">è®°å½•è¿åŠ¨</h3>
                <button onclick="closeExerciseModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="exerciseForm" class="space-y-2">
                <!-- æ­¥æ•°è¾“å…¥ -->
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        ä»Šæ—¥æ­¥æ•° <span class="text-blue-500">*</span>
                    </label>
                    <input 
                        type="number" 
                        id="stepsInput"
                        class="w-full px-3 py-2 rounded-lg border focus:border-blue-500 focus:ring-1 focus:ring-blue-200"
                        placeholder="è¯·è¾“å…¥æ­¥æ•°"
                        required
                    >
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        æ­¥é•¿ï¼ˆå˜ç±³ï¼‰ <span class="text-blue-500">*</span>
                    </label>
                    <input 
                        type="number" 
                        id="strideLength"
                        class="w-full px-3 py-2 rounded-lg border focus:border-blue-500 focus:ring-1 focus:ring-blue-200"
                        placeholder="è¯·è¾“å…¥æ­¥é•¿"
                        required
                        min="50"
                        max="100"
                    >
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        ä½“é‡ï¼ˆå…¬æ–¤ï¼‰ <span class="text-blue-500">*</span>
                    </label>
                    <input 
                        type="number" 
                        id="weightInput"
                        class="w-full px-3 py-2 rounded-lg border focus:border-blue-500 focus:ring-1 focus:ring-blue-200"
                        placeholder="è¯·è¾“å…¥ä½“é‡"
                        required
                        min="30"
                        max="200"
                    >
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        è¿åŠ¨å¼ºåº¦
                    </label>
                    <select 
                        id="intensitySelect"
                        class="w-full px-3 py-2 rounded-lg border focus:border-blue-500 focus:ring-1 focus:ring-blue-200"
                    >
                        <option value="low">ä½å¼ºåº¦</option>
                        <option value="medium">ä¸­ç­‰å¼ºåº¦</option>
                        <option value="high">é«˜å¼ºåº¦</option>
                    </select>
                </div>

                <!-- è¿åŠ¨ç±»å‹ -->
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        è¿åŠ¨ç±»å‹
                    </label>
                    <div class="grid grid-cols-2 gap-2">
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-blue-50 text-sm">
                            <input type="checkbox" name="exerciseType" value="walking">
                            <span>æ­¥è¡Œ</span>
                        </label>
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-blue-50 text-sm">
                            <input type="checkbox" name="exerciseType" value="running">
                            <span>è·‘æ­¥</span>
                        </label>
                    </div>
                </div>

                <!-- æäº¤æŒ‰é’® -->
                <div class="flex space-x-3 pt-2">
                    <button type="button" onclick="closeExerciseModal()" class="flex-1 py-2 rounded-xl border border-blue-500 text-blue-500 font-medium hover:bg-blue-50">
                        å–æ¶ˆ
                    </button>
                    <button type="button" onclick="handleExerciseSubmit(event)" class="flex-1 py-2 rounded-xl bg-blue-500 text-white font-medium hover:bg-blue-600">
                        ä¿å­˜
                    </button>
                </div>
            </form>
        </div>
        
    </div>

   

    <!-- è¿åŠ¨ç›®æ ‡è®¾ç½®å¼¹çª— -->
    <div id="goalModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-full max-w-[500px] bg-white rounded-2xl p-6 shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-gray-800">è®¾ç½®è¿åŠ¨ç›®æ ‡</h3>
                <button onclick="closeGoalModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-2">ç›®æ ‡æ­¥æ•°</label>
                    <input 
                        type="number" 
                        min="1000" 
                        max="50000" 
                        step="1000"
                        value="10000"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200" 
                        placeholder="è¯·è¾“å…¥ç›®æ ‡æ­¥æ•°"
                        oninput="this.value = Math.max(1000, Math.min(50000, Math.floor(this.value/1000)*1000))"
                    >
                    <p class="text-sm text-gray-500 mt-1">å»ºè®®è®¾ç½®èŒƒå›´ï¼š1,000 - 50,000æ­¥</p>
                </div>

                <div class="flex space-x-3">
                    <button onclick="closeGoalModal()" class="flex-1 py-2 rounded-xl border border-blue-500 text-blue-500 font-medium hover:bg-blue-50">
                        å–æ¶ˆ
                    </button>
                    <button onclick="saveGoal()" class="flex-1 py-2 rounded-xl bg-blue-500 text-white font-medium hover:bg-blue-600">
                        ç¡®å®š
                    </button>
                </div>
            </div>
        </div>
        
    </div>

 <!-- ç¡çœ åˆ†æä¸»é¡µé¢ -->
<div id="sleepModule" class="main-module hidden w-full min-h-[calc(100vh-3.5rem)] bg-white rounded-3xl shadow-lg p-6 md:p-8 lg:p-10 relative overflow-hidden space-y-6">
    <!-- é¡¶éƒ¨æ ‡é¢˜ä¿æŒä¸å˜ -->
    <div class="flex justify-between items-center">
        <div>
            <h2 class="text-2xl font-bold text-gray-800">ç¡çœ åˆ†æ</h2>
            <p class="text-gray-500 text-sm current-date"></p>
        </div>
        <button onclick="openSleepModal()" 
                class="w-10 h-10 bg-indigo-500 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-indigo-600 cursor-pointer transition-colors">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- æ ¸å¿ƒæ•°æ®åŒºæ”¹ä¸º2åˆ—å¸ƒå±€ -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- å·¦ä¾§ä¸»æ•°æ®åˆ— -->
        <div class="space-y-6">
            <!-- ç¡çœ è¯„åˆ†å¡ç‰‡ä¼˜åŒ– -->
            <div class="bg-indigo-50 rounded-2xl p-6">
                <div class="flex flex-col items-center">
                    <div class="relative w-32 h-32 mb-4">
                        <!-- æ–°å¢åŠ¨ç”»æ•ˆæœ -->
                        <div class="absolute inset-0 rounded-full border-8 border-indigo-100 animate-pulse"></div>
                        <div class="absolute inset-0 rounded-full border-8 border-indigo-500 border-t-transparent transform -rotate-45"></div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-indigo-600">85</div>
                                <div class="text-sm text-gray-500">è‰¯å¥½</div>
                            </div>
                        </div>
                    </div>
                    <!-- æ–°å¢å‘¼å¸è´¨é‡æŒ‡æ ‡ -->
                    <div class="w-full grid grid-cols-4 gap-4 mt-4">
                        <div class="text-center">
                            <div class="text-lg font-semibold text-indigo-600">7h 30m</div>
                            <div class="text-xs text-gray-500">æ€»æ—¶é•¿</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-semibold text-indigo-600">23:30</div>
                            <div class="text-xs text-gray-500">å…¥ç¡æ—¶é—´</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-semibold text-indigo-600">07:00</div>
                            <div class="text-xs text-gray-500">é†’æ¥æ—¶é—´</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-semibold text-indigo-600">92%</div>
                            <div class="text-xs text-gray-500">å‘¼å¸è´¨é‡</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ–°å¢å‘¨è¶‹åŠ¿æ¨¡å— -->
            <div class="bg-white rounded-2xl p-6 border border-gray-100 shadow-sm">
                <h3 class="text-gray-700 font-semibold mb-4">æœ¬å‘¨ç¡çœ è¶‹åŠ¿</h3>
                <div class="flex items-end justify-between h-32">
                    <div class="flex-1 mx-1 bg-indigo-100 rounded-t-lg" style="height:30%"></div>
                    <div class="flex-1 mx-1 bg-indigo-200 rounded-t-lg" style="height:50%"></div>
                    <div class="flex-1 mx-1 bg-indigo-300 rounded-t-lg" style="height:70%"></div>
                    <div class="flex-1 mx-1 bg-indigo-400 rounded-t-lg" style="height:90%"></div>
                    <div class="flex-1 mx-1 bg-indigo-300 rounded-t-lg" style="height:60%"></div>
                    <div class="flex-1 mx-1 bg-indigo-200 rounded-t-lg" style="height:40%"></div>
                    <div class="flex-1 mx-1 bg-indigo-100 rounded-t-lg" style="height:20%"></div>
                </div>
            </div>
        </div>

        <!-- å³ä¾§è¾…åŠ©æ•°æ®åˆ— -->
        <div class="space-y-6">
            <!-- ä¼˜åŒ–åçš„ç¡çœ é˜¶æ®µåˆ†æ -->
            <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-gray-700 font-semibold">ç¡çœ é˜¶æ®µ</h3>
                    <button onclick="openSleepDetailModal()" class="text-indigo-500 text-sm flex items-center gap-1">
                        <span>è¯¦ç»†æŠ¥å‘Š</span>
                        <i class="fas fa-chevron-right text-xs"></i>
                    </button>
                </div>
                <div class="h-48 relative">
                    <canvas id="sleepStageChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-3 gap-2 text-center">
                    <div class="text-xs">
                        <div class="font-medium text-indigo-600" id="deepSleepTime">3h</div>
                        <div class="text-gray-500">æ·±åº¦ç¡çœ </div>
                    </div>
                    <div class="text-xs">
                        <div class="font-medium text-indigo-400" id="lightSleepTime">3.5h</div>
                        <div class="text-gray-500">æµ…åº¦ç¡çœ </div>
                    </div>
                    <div class="text-xs">
                        <div class="font-medium text-gray-400" id="awakeTime">1h</div>
                        <div class="text-gray-500">æ¸…é†’</div>
                    </div>
                </div>
            </div>

            <!-- æ–°å¢ç¯å¢ƒæ•°æ®å¡ç‰‡ -->
            <div class="bg-indigo-50 rounded-2xl p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">ç¡çœ ç¯å¢ƒ</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-thermometer-half text-indigo-600"></i>
                        </div>
                        <div>
                            <div class="text-sm font-medium">22.5Â°C</div>
                            <div class="text-xs text-gray-500">å®¤æ¸©</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-volume-off text-indigo-600"></i>
                        </div>
                        <div>
                            <div class="text-sm font-medium">32dB</div>
                            <div class="text-xs text-gray-500">å™ªéŸ³</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨å»ºè®®æ¨¡å—ä¼˜åŒ– -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- åŸæœ‰ç¡çœ å»ºè®® -->
        <div class="bg-indigo-50 rounded-2xl p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">ä¸ªæ€§åŒ–å»ºè®®</h3>
            <div class="text-sm text-gray-600 space-y-3">
                <div class="flex items-center gap-2">
                    <i class="fas fa-leaf text-indigo-500"></i>
                    <span>ä¿æŒå§å®¤æ¸©åº¦18-22Â°C</span>
                </div>
                <div class="flex items-center gap-2">
                    <i class="fas fa-ear-deaf text-indigo-500"></i>
                    <span>ä½¿ç”¨è€³å¡é™ä½å™ªéŸ³</span>
                </div>
                <div class="flex items-center gap-2">
                    <i class="fas fa-moon text-indigo-500"></i>
                    <span>ä¿æŒå§å®¤å…‰çº¿æ˜æš—</span>
                </div>
                <div class="flex items-center gap-2">
                    <i class="fas fa-bed text-indigo-500"></i>
                    <span>å°è¯•æå‰30åˆ†é’Ÿä¸ŠåºŠ</span>
                </div>
            </div>
        </div>

        <!-- æ–°å¢å¿ƒç‡ç›‘æµ‹ -->
        <div class="bg-indigo-50 rounded-2xl p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">å¤œé—´å¿ƒç‡</h3>
            <div class="flex items-center justify-between">
                <div class="text-3xl font-bold text-indigo-600">58</div>
                <div class="text-sm text-gray-500">å¹³å‡bpm</div>
            </div>
            <div class="h-20 mt-4 bg-white rounded-lg p-2">
                <div class="flex items-end h-full gap-px">
                    <!-- ç¤ºä¾‹å¿ƒç‡æ³¢å½¢ -->
                    <div class="w-2 bg-indigo-100" style="height:30%"></div>
                    <div class="w-2 bg-indigo-200" style="height:50%"></div>
                    <div class="w-2 bg-indigo-300" style="height:70%"></div>
                    <!-- æ›´å¤šæ³¢å½¢æ¡... -->
                </div>
            </div>
        </div>
    </div>
</div>



 <!-- ç»æœŸè®°å½•ä¸»é¡µé¢ -->
<div id="periodModule" class="main-module hidden w-full min-h-[calc(100vh-3.5rem)] bg-white rounded-3xl shadow-lg p-6 md:p-8 lg:p-10 relative overflow-hidden">
    <!-- å¤´éƒ¨åŒºåŸŸ -->
    <div class="flex justify-between items-center mb-6">
        <div>
            <h2 class="text-2xl font-bold text-gray-800">ç»æœŸè®°å½•</h2>
            <p class="text-gray-500 text-sm" id="currentDate"></p>
        </div>
        <button onclick="openPeriodModal()" class="w-10 h-10 bg-pink-500 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-pink-600 transition-colors">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- é¡¶éƒ¨åŒå¡ç‰‡å¸ƒå±€ -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <!-- åŸæœ‰ç»æœŸé¢„æµ‹å¡ç‰‡ -->
        <div class="bg-pink-50 rounded-2xl p-4 border border-pink-100">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="font-medium text-gray-800">ä¸‹æ¬¡ç»æœŸé¢„æµ‹</h3>
                    <p class="text-pink-600 text-sm mt-1">å¹³å‡å‘¨æœŸ28å¤©</p>
                </div>
                <span class="bg-white text-pink-500 text-xs px-3 py-1 rounded-full font-medium shadow-sm">
                    è¿˜æœ‰12å¤©
                </span>
            </div>
            <div class="w-full h-2 bg-pink-100 rounded-full mt-4">
                <div class="w-[60%] h-full bg-pink-300 rounded-full"></div>
            </div>
            <div class="flex justify-between mt-2 text-sm text-gray-600">
                <span>ä¸Šæ¬¡ï¼š3æœˆ9æ—¥</span>
                <span>é¢„æµ‹ï¼š4æœˆ2æ—¥</span>
            </div>
        </div>

        <!-- æ–°å¢å‘¨æœŸç»Ÿè®¡å¡ç‰‡ -->
        <div class="bg-pink-50 rounded-2xl p-4 border border-pink-100">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="font-medium text-gray-800">å‘¨æœŸç»Ÿè®¡</h3>
                    <p class="text-pink-600 text-sm mt-1">æœ€è¿‘6ä¸ªå‘¨æœŸ</p>
                </div>
                <i class="fas fa-chart-pie text-pink-400"></i>
            </div>
            <div class="grid grid-cols-3 gap-4 text-center">
                <div>
                    <p class="text-xs text-gray-600 mb-1">å¹³å‡å‘¨æœŸ</p>
                    <p class="text-lg font-bold text-pink-600">28å¤©</p>
                </div>
                <div>
                    <p class="text-xs text-gray-600 mb-1">å¹³å‡ç»æœŸ</p>
                    <p class="text-lg font-bold text-pink-600">5å¤©</p>
                </div>
                <div>
                    <p class="text-xs text-gray-600 mb-1">è§„å¾‹æ€§</p>
                    <p class="text-lg font-bold text-pink-600">92%</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸­é—´åŒåˆ—å¸ƒå±€ -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
    

        <!-- æ–°å¢ç”¨è¯æé†’å¡ç‰‡ -->
        <div class="bg-pink-50 rounded-2xl p-4 border border-pink-100">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-gray-700 font-medium">ç”¨è¯æé†’</h3>
                <button class="w-8 h-8 bg-pink-100 rounded-full flex items-center justify-center text-pink-500 hover:bg-pink-200">
                    <i class="fas fa-plus text-sm"></i>
                </button>
            </div>
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-pink-600">å¸ƒæ´›èŠ¬ç¼“é‡Šèƒ¶å›Š</div>
                            <div class="text-xs text-gray-500 mt-1">ä¸‹æ¬¡ï¼š14:00</div>
                        </div>
                        <i class="fas fa-bell text-pink-400"></i>
                    </div>
                </div>
                <div class="text-center text-pink-500 text-sm py-2 hover:bg-pink-100 rounded-lg cursor-pointer">
                    + æ·»åŠ æ–°æé†’
                </div>
            </div>
        </div>

        <!-- å¥åº·å»ºè®® -->
        <div class="bg-pink-50 rounded-2xl p-6">
            <h3 class="text-xl font-bold text-pink-600 mb-4">å¥åº·å»ºè®®</h3>
            <div class="space-y-3">
                <div class="flex items-start">
                    <i class="fas fa-check text-pink-500 mt-1 mr-2"></i>
                    <div class="text-gray-700 text-sm">ä¿æŒå……è¶³ç¡çœ ï¼Œæ¯å¤©è‡³å°‘7-8å°æ—¶</div>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check text-pink-500 mt-1 mr-2"></i>
                    <div class="text-gray-700 text-sm">é€‚é‡è¿åŠ¨ï¼Œå¦‚ç‘œä¼½æˆ–æ•£æ­¥</div>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check text-pink-500 mt-1 mr-2"></i>
                    <div class="text-gray-700 text-sm">ä¿æŒå‡è¡¡é¥®é£Ÿï¼Œè¡¥å……é“å…ƒç´ </div>
                </div>
            </div>
    
    </div>
    </div>
<div>
        <!-- æ—¥å†ä¸»ä½“ -->
        <div class="w-full max-w-[1200px] min-h-[600px] bg-white rounded-3xl shadow-lg p-6 md:p-8 lg:p-10 relative overflow-hidden mx-auto">
            <!-- æœˆä»½å¯¼èˆª -->
            <div class="flex justify-between items-center mb-6">
                <button onclick="changeMonth(-1)" class="p-2 hover:bg-gray-100 rounded-lg">
                    <i class="fas fa-chevron-left text-gray-600"></i>
                </button>
                <h3 class="text-xl font-bold text-gray-800" id="currentMonthLabel">2024å¹´3æœˆ</h3>
                <button onclick="changeMonth(1)" class="p-2 hover:bg-gray-100 rounded-lg">
                    <i class="fas fa-chevron-right text-gray-600"></i>
                </button>
            </div>

            <!-- æ˜ŸæœŸè¡¨å¤´ -->
            <div class="grid grid-cols-7 mb-4">
                <div class="text-center text-gray-500">æ—¥</div>
                <div class="text-center text-gray-500">ä¸€</div>
                <div class="text-center text-gray-500">äºŒ</div>
                <div class="text-center text-gray-500">ä¸‰</div>
                <div class="text-center text-gray-500">å››</div>
                <div class="text-center text-gray-500">äº”</div>
                <div class="text-center text-gray-500">å…­</div>
            </div>

            <!-- æ—¥æœŸç½‘æ ¼ -->
            <div id="calendarGrid" class="grid grid-cols-7 gap-2"></div>
        </div>

     
        </div>
</div>

<!-- å¼¹çª—éƒ¨åˆ†ä¿æŒåŸæœ‰ä»£ç ä¸å˜ -->

    <!-- ç»æœŸè®°å½•å¼¹çª— -->
    <div id="periodModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-[600px] bg-white rounded-[2rem] p-6 shadow-lg max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-gray-800">è®°å½•ç»æœŸ</h3>
                <button onclick="closePeriodModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="periodForm" class="space-y-4">
                <!-- æ—¥æœŸé€‰æ‹© -->
                <div class="space-y-3">
                    <div>
                        <label class="block text-gray-700 text-sm font-medium mb-1">
                            å¼€å§‹æ—¥æœŸ <span class="text-pink-500">*</span>
                        </label>
                        <input 
                            type="date" 
                            id="periodStartDate"
                            class="w-full px-3 py-2 rounded-lg border focus:border-pink-500 focus:ring-1 focus:ring-pink-200"
                            required
                        >
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-medium mb-1">
                            ç»“æŸæ—¥æœŸ
                        </label>
                        <input 
                            type="date" 
                            id="periodEndDate"
                            class="w-full px-3 py-2 rounded-lg border focus:border-pink-500 focus:ring-1 focus:ring-pink-200"
                        >
                    </div>
                </div>

                <!-- ç»æœŸçŠ¶æ€ -->
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        å‡ºè¡€é‡ <span class="text-pink-500">*</span>
                    </label>
                    <div class="flex justify-between space-x-2">
                        <button type="button" onclick="selectFlow(this, 'light')" class="flow-btn flex-1 py-2 rounded-lg border border-gray-200 text-sm hover:bg-pink-50">
                            å°‘é‡
                        </button>
                        <button type="button" onclick="selectFlow(this, 'medium')" class="flow-btn flex-1 py-2 rounded-lg border border-gray-200 text-sm hover:bg-pink-50">
                            ä¸­ç­‰
                        </button>
                        <button type="button" onclick="selectFlow(this, 'heavy')" class="flow-btn flex-1 py-2 rounded-lg border border-gray-200 text-sm hover:bg-pink-50">
                            è¾ƒå¤š
                        </button>
                    </div>
                    <input type="hidden" id="selectedFlow" value="">
                </div>

                <!-- ç—‡çŠ¶é€‰æ‹© -->
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        ç—‡çŠ¶ï¼ˆå¯å¤šé€‰ï¼‰
                    </label>
                    <div class="grid grid-cols-2 gap-2">
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-pink-50 text-sm">
                            <input type="checkbox" name="symptoms" value="cramps">
                            <span>ç—›ç»</span>
                        </label>
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-pink-50 text-sm">
                            <input type="checkbox" name="symptoms" value="headache">
                            <span>å¤´ç—›</span>
                        </label>
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-pink-50 text-sm">
                            <input type="checkbox" name="symptoms" value="breast_tenderness">
                            <span>ä¹³æˆ¿èƒ€ç—›</span>
                        </label>
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-pink-50 text-sm">
                            <input type="checkbox" name="symptoms" value="fatigue">
                            <span>ç–²åŠ³</span>
                        </label>
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-pink-50 text-sm">
                            <input type="checkbox" name="symptoms" value="mood_swings">
                            <span>æƒ…ç»ªæ³¢åŠ¨</span>
                        </label>
                        <label class="flex items-center space-x-2 p-2 rounded-lg border border-gray-200 hover:bg-pink-50 text-sm">
                            <input type="checkbox" name="symptoms" value="bloating">
                            <span>è…¹èƒ€</span>
                        </label>
                    </div>
                </div>

                <!-- å¿ƒæƒ…è®°å½• -->
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        ä»Šæ—¥å¿ƒæƒ…
                    </label>
                    <div class="flex justify-between">
                        <button type="button" onclick="selectMood(this, 'bad')" class="mood-btn p-2 rounded-lg border border-gray-200 hover:bg-pink-50">ğŸ˜«</button>
                        <button type="button" onclick="selectMood(this, 'poor')" class="mood-btn p-2 rounded-lg border border-gray-200 hover:bg-pink-50">ğŸ˜”</button>
                        <button type="button" onclick="selectMood(this, 'normal')" class="mood-btn p-2 rounded-lg border border-gray-200 hover:bg-pink-50">ğŸ˜</button>
                        <button type="button" onclick="selectMood(this, 'good')" class="mood-btn p-2 rounded-lg border border-gray-200 hover:bg-pink-50">ğŸ˜Š</button>
                        <button type="button" onclick="selectMood(this, 'great')" class="mood-btn p-2 rounded-lg border border-gray-200 hover:bg-pink-50">ğŸ˜ƒ</button>
                    </div>
                    <input type="hidden" id="selectedMood" value="">
                </div>

                <!-- å¤‡æ³¨ -->
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        å¤‡æ³¨
                    </label>
                    <textarea 
                        id="periodNotes"
                        class="w-full px-3 py-2 rounded-lg border focus:border-pink-500 focus:ring-1 focus:ring-pink-200"
                        rows="2"
                        placeholder="è®°å½•å…¶ä»–ç—‡çŠ¶æˆ–æ„Ÿå—..."
                    ></textarea>
                </div>

                <!-- æäº¤æŒ‰é’® -->
                <div class="flex space-x-3 pt-2">
                    <button type="button" onclick="closePeriodModal()" class="flex-1 py-2 rounded-xl border border-pink-500 text-pink-500 font-medium hover:bg-pink-50">
                        å–æ¶ˆ
                    </button>
                    <button type="button" onclick="handlePeriodSubmit(event)" class="flex-1 py-2 rounded-xl bg-pink-500 text-white font-medium hover:bg-pink-600">
                        ä¿å­˜
                    </button>
                </div>
            </form>
        </div>
        
    </div>

    <!-- å†å²è®°å½•è¯¦æƒ…å¼¹çª— -->
    <div id="historyModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-80 bg-white rounded-3xl p-6 max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-800">ç»æœŸå†å²è®°å½•</h3>
                <button onclick="closeHistoryModal()" class="text-gray-500">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-4" id="historyList">
                <!-- å†å²è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€å¡«å…… -->
            </div>
        </div>
        
    </div>

    <!-- æ—¥æœŸè¯¦æƒ…å¼¹çª— -->
    <div id="dayDetailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-80 bg-white rounded-3xl p-6">
            <!-- å¼¹çª—æ ‡é¢˜å’Œå…³é—­æŒ‰é’® -->
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800" id="modalDate"></h3>
                <button onclick="closeModal('dayDetailModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- å¿ƒæƒ…è®°å½• -->
            <div class="bg-pink-50 rounded-xl p-4 mb-4">
                <div class="flex justify-between items-center mb-2">
                    <h4 class="text-gray-700 font-medium">ä»Šæ—¥å¿ƒæƒ…</h4>
                    <button onclick="openMoodPicker()" class="text-pink-500 hover:text-pink-600">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>
                <div id="currentMood" class="flex items-center space-x-2">
                    <span class="text-2xl">ğŸ˜</span>
                    <span class="text-sm text-gray-500">æš‚æ— è®°å½•</span>
                </div>
            </div>

            <!-- ç»æœŸçŠ¶æ€ -->
            <div class="bg-pink-50 rounded-xl p-4">
                <h4 class="text-gray-700 font-medium mb-2">ç»æœŸçŠ¶æ€</h4>
                <div id="periodStatus" class="text-sm text-gray-600">
                    æš‚æ— è®°å½•
                </div>
            </div>
        </div>
        
    </div>

    <!-- å¿ƒæƒ…é€‰æ‹©å¼¹çª— -->
    <div id="moodPickerModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-80 bg-white rounded-3xl p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">é€‰æ‹©å¿ƒæƒ…</h3>
                <button onclick="closeModal('moodPickerModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="grid grid-cols-4 gap-4" id="moodGrid"></div>
        </div>
        
    </div>

        <!-- ä¸ªäººä¸»é¡µæ¨¡å— - å¥åº·æ•°æ®ä»ªè¡¨ç›˜ -->
<div id="profileModule" class="main-module hidden w-full min-h-[calc(100vh-3.5rem)] bg-white rounded-3xl shadow-lg p-6 md:p-8 lg:p-10 relative overflow-hidden">

    <!-- å¤´éƒ¨ä¿¡æ¯åŒº -->
    <section class="mb-10 relative">
      <!-- æ¸å˜èƒŒæ™¯å±‚ -->
      <div class="absolute inset-0 bg-gradient-to-r from-emerald-50 to-cyan-50 opacity-50 rounded-2xl -m-4"></div>
      
      <!-- ç”¨æˆ·èº«ä»½åŒº -->
      <div class="relative flex flex-col md:flex-row items-center gap-6">
        <!-- åŠ¨æ€å¤´åƒ -->
        <div class="relative group">
          <div class="absolute inset-0 rounded-full bg-gradient-to-br from-emerald-400 to-cyan-400 blur-lg opacity-30 group-hover:opacity-50 transition-opacity"></div>
          <div class="relative">
            <img src="https://placehold.co/120x120" alt="ç”¨æˆ·å¤´åƒ" 
                 class="w-24 h-24 rounded-full border-4 border-white/80 shadow-lg transition-transform duration-300 hover:scale-105">
            <!-- ç›¸æœºæŒ‰é’® -->
            <button class="absolute -bottom-2 -right-2 bg-white rounded-full p-2 shadow-lg hover:shadow-xl transition-all
                          border-2 border-emerald-100 hover:border-emerald-200">
              <i class="fas fa-camera text-emerald-600 text-sm w-6 h-6 flex items-center justify-center"></i>
            </button>
          </div>
        </div>
  
        <!-- ç”¨æˆ·ä¿¡æ¯ -->
        <div class="text-center md:text-left space-y-1">
          <h1 class="text-2xl font-bold text-gray-800 flex items-center gap-2 justify-center md:justify-start">
            Jane Cooper
            <span class="text-emerald-500 text-lg">
              <i class="fas fa-badge-check"></i>
            </span>
          </h1>
          <p class="text-gray-500">å¥åº·è¾¾äºº Â· è¿ç»­æ‰“å¡127å¤©</p>
          <div class="flex items-center gap-2 text-sm text-gray-500 justify-center md:justify-start">
            <i class="fas fa-location-dot"></i>
            <span>ä¸Šæµ· Â· 28å²</span>
          </div>
        </div>
      </div>
    </section>
  
    <!-- æ ¸å¿ƒå¥åº·æŒ‡æ ‡ -->
    <section class="mb-10">
      <!-- æŒ‡æ ‡å¯¼èˆª -->
      <div class="flex items-center justify-between mb-6 px-2">
        <h2 class="text-xl font-bold text-gray-800">ä»Šæ—¥å¥åº·æ•°æ®</h2>
        <div class="flex gap-2">
          <button class="text-emerald-600 hover:text-emerald-700 flex items-center gap-1">
            <span>æœ¬å‘¨è¶‹åŠ¿</span>
            <i class="fas fa-chart-line text-sm"></i>
          </button>
        </div>
      </div>
  
      <!-- æŒ‡æ ‡å¡ç‰‡ç»„ -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- åŠ¨æ€æ­¥æ•°å¡ç‰‡ -->
        <div class="bg-gradient-to-br from-blue-50 to-emerald-50 rounded-2xl p-5 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-24 h-24 bg-cyan-100/30 rounded-bl-full"></div>
          <div class="relative">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center text-white">
                <i class="fas fa-walking"></i>
              </div>
              <h3 class="font-semibold text-gray-700">è¿åŠ¨æ•°æ®</h3>
            </div>
            <div class="space-y-3">
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">ä»Šæ—¥æ­¥æ•°</span>
                <span class="font-medium text-blue-600">8,547</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">è¾¾æ ‡ç‡</span>
                <div class="relative w-20 h-2 bg-cyan-100 rounded-full">
                  <div class="absolute left-0 h-full bg-blue-500 rounded-full w-3/4"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <!-- ç¡çœ è´¨é‡å¡ç‰‡ -->
        <div class="bg-gradient-to-br from-indigo-50 to-blue-50 rounded-2xl p-5 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-24 h-24 bg-indigo-100/30 rounded-bl-full"></div>
          <div class="relative">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-10 h-10 bg-indigo-500 rounded-lg flex items-center justify-center text-white">
                <i class="fas fa-moon"></i>
              </div>
              <h3 class="font-semibold text-gray-700">ç¡çœ åˆ†æ</h3>
            </div>
            <div class="space-y-3">
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">æ·±ç¡æ—¶é•¿</span>
                <span class="font-medium text-indigo-600">2h15m</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">è´¨é‡è¯„åˆ†</span>
                <div class="flex items-center gap-1">
                  <i class="fas fa-star text-yellow-400"></i>
                  <span class="font-medium">4.2</span>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <!-- ç”Ÿç†å‘¨æœŸå¡ç‰‡ -->
        <div class="bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl p-5 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-24 h-24 bg-pink-100/30 rounded-bl-full"></div>
          <div class="relative">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-10 h-10 bg-pink-500 rounded-lg flex items-center justify-center text-white">
                <i class="fas fa-venus"></i>
              </div>
              <h3 class="font-semibold text-gray-700">ç”Ÿç†å‘¨æœŸ</h3>
            </div>
            <div class="space-y-3">
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">å½“å‰é˜¶æ®µ</span>
                <span class="font-medium text-pink-600">ç»æœŸç¬¬2å¤©</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">å‰©ä½™å¤©æ•°</span>
                <span class="font-medium text-pink-600">3å¤©</span>
              </div>
            </div>
          </div>
        </div>
  
        <!-- é¥®æ°´è¿½è¸ªå¡ç‰‡ -->
        <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-5 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-24 h-24 bg-amber-100/30 rounded-bl-full"></div>
          <div class="relative">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center text-white">
                    <i class="fas fa-glass-water-droplet text-lg"></i> <!-- ä¿®æ”¹åçš„è¡Œ -->
                  </div>
              <h3 class="font-semibold text-gray-700">é¥®æ°´è®°å½•</h3>
            </div>
            <div class="space-y-3">
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">ä»Šæ—¥é¥®æ°´</span>
                <span class="font-medium text-amber-600">1.2L</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600 text-sm">ç›®æ ‡è¿›åº¦</span>
                <div class="relative w-20 h-2 bg-amber-100 rounded-full">
                  <div class="absolute left-0 h-full bg-amber-500 rounded-full w-2/3"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  
    <!-- å¥åº·æ•°æ®å¯è§†åŒ– -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- BMIç¯å½¢å›¾ -->
      <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-lg font-semibold text-gray-800">ä½“é‡ç®¡ç†</h3>
          <button onclick="openWeightModal()" class="text-emerald-600 hover:text-emerald-700 text-sm flex items-center gap-1">
            <i class="fas fa-edit"></i>
            <span>è®°å½•æ•°æ®</span>
          </button>
        </div>
        <div class="flex flex-col lg:flex-row items-center gap-8">
          <div class="relative w-48 h-48">
            <div class="absolute inset-0 rounded-full border-8 border-gray-100"></div>
            <div class="absolute inset-0 rounded-full border-8 border-emerald-500 border-t-transparent -rotate-45"></div>
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="text-center">
                <div class="text-3xl font-bold text-emerald-600">22.1</div>
                <div class="text-sm text-gray-500">å¥åº· BMI</div>
              </div>
            </div>
          </div>
          <div class="flex-1 w-full space-y-4">
            <div class="flex items-center justify-between p-3 bg-emerald-50 rounded-lg">
              <div class="text-sm text-gray-600">å½“å‰ä½“é‡</div>
              <div class="font-medium text-emerald-600">58.6 kg</div>
            </div>
            <div class="flex items-center justify-between p-3 bg-emerald-50 rounded-lg">
              <div class="text-sm text-gray-600">ç›®æ ‡ä½“é‡</div>
              <div class="font-medium text-emerald-600">55.0 kg</div>
            </div>
            <div class="flex items-center justify-between p-3 bg-emerald-50 rounded-lg">
              <div class="text-sm text-gray-600">ä½“è„‚ç‡</div>
              <div class="font-medium text-emerald-600">24.5%</div>
            </div>
          </div>
        </div>
      </div>
  
      <!-- å¥åº·è¶‹åŠ¿å›¾ -->
      <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-lg font-semibold text-gray-800">æ¯å‘¨æ´»åŠ¨è¶‹åŠ¿</h3>
          <div class="flex gap-2">
            <button class="text-gray-500 hover:text-emerald-600 px-3 py-1 rounded-lg text-sm">æ­¥æ•°</button>
            <button class="text-gray-500 hover:text-emerald-600 px-3 py-1 rounded-lg text-sm">å¡è·¯é‡Œ</button>
            <button class="text-gray-500 hover:text-emerald-600 px-3 py-1 rounded-lg text-sm">å¿ƒç‡</button>
          </div>
        </div>
        <div class="h-64 bg-gray-50 rounded-xl animate-pulse">
          <!-- æ­¤å¤„å¯é›†æˆå›¾è¡¨åº“ -->
        </div>
      </div>
    </section>
  </div>

  <!-- åœ¨ä¸ªäººä¸»é¡µæ¨¡å—æœ«å°¾æ·»åŠ ä½“é‡è®°å½•å¼¹çª— -->
<div id="weightModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="w-full max-w-md bg-white rounded-2xl p-6 shadow-xl">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold text-gray-800">è®°å½•èº«ä½“æ•°æ®</h3>
        <button onclick="closeWeightModal()" class="text-gray-400 hover:text-gray-600">
          <i class="fas fa-times text-lg"></i>
        </button>
      </div>
      
      <form class="space-y-4">
        <!-- ä½“é‡è¾“å…¥ -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">å½“å‰ä½“é‡ (kg)</label>
          <div class="relative">
            <input type="number" step="0.1" 
                   class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"
                   placeholder="58.6">
            <div class="absolute inset-y-0 right-3 flex items-center">
              <span class="text-gray-400">kg</span>
            </div>
          </div>
        </div>
  
        <!-- ä½“è„‚ç‡è¾“å…¥ -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ä½“è„‚ç‡ (%)</label>
          <div class="relative">
            <input type="number" step="0.1"
                   class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"
                   placeholder="24.5">
            <div class="absolute inset-y-0 right-3 flex items-center">
              <span class="text-gray-400">%</span>
            </div>
          </div>
        </div>
  
        <!-- è®°å½•æ—¶é—´ -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">è®°å½•æ—¶é—´</label>
          <input type="datetime-local" 
                 class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
        </div>
  
        <!-- æ“ä½œæŒ‰é’® -->
        <div class="flex gap-3 pt-4">
          <button type="button" onclick="closeWeightModal()" 
                  class="flex-1 py-3 rounded-xl border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors">
            å–æ¶ˆ
          </button>
          <button type="submit" 
                  class="flex-1 py-3 rounded-xl bg-emerald-500 text-white hover:bg-emerald-600 transition-colors">
            ä¿å­˜æ•°æ®
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <script>
  // ä½“é‡è®°å½•å¼¹çª—æ§åˆ¶
  function openWeightModal() {
    document.getElementById('weightModal').classList.remove('hidden')
  }
  
  function closeWeightModal() {
    document.getElementById('weightModal').classList.add('hidden')
  }
  </script>

     <!-- ç¡çœ æ•°æ®å½•å…¥å¼¹çª— -->
     <div id="sleepModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-full max-w-[500px] bg-white rounded-2xl p-6 shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-gray-800">è®°å½•ç¡çœ </h3>
                <button onclick="closeSleepModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="sleepForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-2">å…¥ç¡æ—¶é—´</label>
                    <input 
                        type="time" 
                        id="sleepTimeInput"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200" 
                        required
                    >
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-2">èµ·åºŠæ—¶é—´</label>
                    <input 
                        type="time" 
                        id="wakeTimeInput"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200" 
                        required
                    >
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-2">ç¡çœ è´¨é‡</label>
                    <select 
                        id="qualitySelect"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200"
                    >
                        <option value="excellent">éå¸¸å¥½</option>
                        <option value="good">å¥½</option>
                        <option value="fair">ä¸€èˆ¬</option>
                        <option value="poor">å·®</option>
                    </select>
                </div>

                <div class="flex space-x-3">
                    <button onclick="closeSleepModal()" class="flex-1 py-2 rounded-xl border border-indigo-500 text-indigo-500 font-medium hover:bg-indigo-50">
                        å–æ¶ˆ
                    </button>
                    <button onclick="handleSleepSubmit(event)" class="flex-1 py-2 rounded-xl bg-indigo-500 text-white font-medium hover:bg-indigo-600">
                        ä¿å­˜
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- BMIè®°å½•å¼¹çª— -->
    <div id="bmiModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="w-full max-w-[800px] bg-white rounded-2xl p-4 shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-gray-800">è®°å½•BMI</h3>
                <button onclick="closeBmiModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="bmiForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        ä½“é‡(kg) <span class="text-emerald-500">*</span>
                    </label>
                    <input 
                        type="number" 
                        id="weightInput"
                        step="0.1"
                        class="w-full px-3 py-2 rounded-lg border focus:border-emerald-500 focus:ring-1 focus:ring-emerald-200"
                        required
                    >
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">
                        èº«é«˜(cm) <span class="text-emerald-500">*</span>
                    </label>
                    <input 
                        type="number" 
                        id="heightInput"
                        step="0.1"
                        class="w-full px-3 py-2 rounded-lg border focus:border-emerald-500 focus:ring-1 focus:ring-emerald-200"
                        required
                    >
                </div>

                <div class="flex space-x-3 pt-2">
                    <button type="button" onclick="closeBmiModal()" class="flex-1 py-2 rounded-xl border border-emerald-500 text-emerald-500 font-medium hover:bg-emerald-50">
                        å–æ¶ˆ
                    </button>
                    <button type="button" onclick="handleBmiSubmit(event)" class="flex-1 py-2 rounded-xl bg-emerald-500 text-white font-medium hover:bg-emerald-600">
                        ä¿å­˜
                    </button>
                </div>
            </form>
        </div>
        
    </div>

</div>

<!-- Toastæç¤º -->
<div id="toast" class="hidden fixed top-4 right-4 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg">
    <p id="toastMessage"></p>
</div>

<script>
// å…¨å±€å˜é‡
let currentDate = new Date();
let selectedDate = null;

// å¿ƒæƒ…é€‰é¡¹
const moods = [
    { emoji: 'ğŸ˜Š', text: 'å¼€å¿ƒ' },
    { emoji: 'ğŸ¥°', text: 'å¹¸ç¦' },
    { emoji: 'ğŸ˜´', text: 'ç–²æƒ«' },
    { emoji: 'ğŸ˜¢', text: 'éš¾è¿‡' },
    { emoji: 'ğŸ˜¡', text: 'çƒ¦èº' },
    { emoji: 'ğŸ¤’', text: 'ä¸é€‚' },
    { emoji: 'ğŸ˜«', text: 'ç—›ç»' },
    { emoji: 'ğŸ¤”', text: 'å›°æƒ‘' }
];

// åˆå§‹åŒ–æ—¥å†
function initCalendar() {
    updateCalendar();
    setupMoodPicker();
}

// æ›´æ–°æ—¥å†æ˜¾ç¤º
function updateCalendar() {
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    
    // æ›´æ–°æœˆä»½æ ‡ç­¾
    document.getElementById('currentMonthLabel').textContent = 
        `${year}å¹´${month + 1}æœˆ`;
    
    const grid = document.getElementById('calendarGrid');
    grid.innerHTML = '';
    
    // è·å–æœˆä»½çš„ç¬¬ä¸€å¤©å’Œæœ€åä¸€å¤©
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    
    // å¡«å……æ—¥æœŸ
    const firstDayOfWeek = firstDay.getDay();
    const totalDays = lastDay.getDate();
    
    // ä¸Šä¸ªæœˆçš„æ—¥æœŸ
    for (let i = 0; i < firstDayOfWeek; i++) {
        const prevDate = new Date(year, month, -firstDayOfWeek + i + 1);
        addDateToGrid(prevDate, true);
    }
    
    // å½“å‰æœˆçš„æ—¥æœŸ
    for (let i = 1; i <= totalDays; i++) {
        const date = new Date(year, month, i);
        addDateToGrid(date, false);
    }
    
    // ä¸‹ä¸ªæœˆçš„æ—¥æœŸ
    const remainingDays = 42 - (firstDayOfWeek + totalDays);
    for (let i = 1; i <= remainingDays; i++) {
        const nextDate = new Date(year, month + 1, i);
        addDateToGrid(nextDate, true);
    }
}

// æ·»åŠ æ—¥æœŸåˆ°ç½‘æ ¼
function addDateToGrid(date, isOtherMonth) {
    const grid = document.getElementById('calendarGrid');
    const dateDiv = document.createElement('div');
    
    dateDiv.className = `
        relative h-10 rounded-lg flex flex-col items-center justify-center
        cursor-pointer hover:bg-pink-50 transition-colors
        ${isOtherMonth ? 'text-gray-400' : 'text-gray-700'}
    `;
    
    // æ—¥æœŸæ•°å­—
    const dateNum = document.createElement('div');
    dateNum.textContent = date.getDate();
    dateNum.className = 'text-sm';
    dateDiv.appendChild(dateNum);
    
    // æ·»åŠ å¿ƒæƒ…å›¾æ ‡ï¼ˆå¦‚æœæœ‰ï¼‰
    const mood = getMood(date);
    if (mood) {
        const moodIcon = document.createElement('div');
        moodIcon.className = 'text-xs absolute bottom-1';
        moodIcon.textContent = mood.emoji;
        dateDiv.appendChild(moodIcon);
    }
    
    // æ·»åŠ ç‚¹å‡»äº‹ä»¶
    dateDiv.addEventListener('click', () => showDayDetail(date));
    
    grid.appendChild(dateDiv);
}

// æ˜¾ç¤ºæ—¥æœŸè¯¦æƒ…
function showDayDetail(date) {
    selectedDate = date;
    
    // æ›´æ–°å¼¹çª—æ—¥æœŸ
    const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
    document.getElementById('modalDate').textContent = 
        date.toLocaleDateString('zh-CN', options);
    
    // æ›´æ–°å¿ƒæƒ…æ˜¾ç¤º
    updateMoodDisplay();
    
    // æ˜¾ç¤ºå¼¹çª—
    document.getElementById('dayDetailModal').classList.remove('hidden');
}

// è®¾ç½®å¿ƒæƒ…é€‰æ‹©å™¨
function setupMoodPicker() {
    const grid = document.getElementById('moodGrid');
    grid.innerHTML = moods.map(mood => `
        <button 
            onclick="selectMood('${mood.emoji}', '${mood.text}')"
            class="p-3 hover:bg-pink-50 rounded-xl flex flex-col items-center"
        >
            <span class="text-2xl mb-1">${mood.emoji}</span>
            <span class="text-xs text-gray-600">${mood.text}</span>
        </button>
    `).join('');
}

// æ‰“å¼€å¿ƒæƒ…é€‰æ‹©å™¨
function openMoodPicker() {
    document.getElementById('moodPickerModal').classList.remove('hidden');
}

// é€‰æ‹©å¿ƒæƒ…
function selectMood(button, value) {
    document.querySelectorAll('.mood-btn').forEach(btn => {
        btn.classList.remove('bg-pink-500', 'text-white', 'border-pink-500');
        btn.classList.add('border-gray-200');
    });
    
    button.classList.remove('border-gray-200');
    button.classList.add('bg-pink-500', 'text-white', 'border-pink-500');
    
    document.getElementById('selectedMood').value = value;
}

// æ›´æ–°å¿ƒæƒ…æ˜¾ç¤º
function updateMoodDisplay() {
    const mood = getMood(selectedDate);
    const display = document.getElementById('currentMood');
    
    if (mood) {
        display.innerHTML = `
            <span class="text-2xl">${mood.emoji}</span>
            <span class="text-sm text-gray-600">${mood.text}</span>
        `;
    } else {
        display.innerHTML = `
            <span class="text-2xl">ğŸ˜</span>
            <span class="text-sm text-gray-500">æš‚æ— è®°å½•</span>
        `;
    }
}

// è·å–æŒ‡å®šæ—¥æœŸçš„å¿ƒæƒ…
function getMood(date) {
    const moods = JSON.parse(localStorage.getItem('moods') || '{}');
    const dateStr = date.toISOString().split('T')[0];
    return moods[dateStr];
}

// ä¿å­˜å¿ƒæƒ…
function saveMood(moodData) {
    const moods = JSON.parse(localStorage.getItem('moods') || '{}');
    const dateStr = new Date(moodData.date).toISOString().split('T')[0];
    moods[dateStr] = {
        emoji: moodData.emoji,
        text: moodData.text
    };
    localStorage.setItem('moods', JSON.stringify(moods));
}

// åˆ‡æ¢æœˆä»½
function changeMonth(delta) {
    currentDate.setMonth(currentDate.getMonth() + delta);
    updateCalendar();
}

// å…³é—­å¼¹çª—
function closeModal(modalId) {
    document.getElementById(modalId).classList.add('hidden');
    if (modalId === 'dayDetailModal') {
        selectedDate = null;
    }
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', initCalendar);

// æ·»åŠ ç‚¹å‡»é®ç½©å±‚å…³é—­å¼¹çª—
document.querySelectorAll('.fixed').forEach(modal => {
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeModal(modal.id);
        }
    });
});

// æ·»åŠ ESCé”®å…³é—­å¼¹çª—
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeModal('dayDetailModal');
        closeModal('moodPickerModal');
    }
});

let sleepStageChart = null;

// åˆå§‹åŒ–ç¡çœ é˜¶æ®µå›¾è¡¨
function initializeSleepStageChart() {
    const ctx = document.getElementById('sleepStageChart');
    if (!ctx) return;

    // é”€æ¯ç°æœ‰å›¾è¡¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
    if (sleepStageChart) {
        sleepStageChart.destroy();
    }

    sleepStageChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'ç¡çœ é˜¶æ®µ',
                data: [],
                borderColor: '#6366f1',
                backgroundColor: 'rgba(99, 102, 241, 0.1)',
                fill: true,
                stepped: true,
                tension: 0,
                pointRadius: 4,
                pointBackgroundColor: '#6366f1',
                pointBorderColor: '#ffffff',
                pointBorderWidth: 2,
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    min: -0.5,
                    max: 2.5,
                    ticks: {
                        stepSize: 1,
                        callback: function(value) {
                            switch (value) {
                                case 0: return 'æ¸…é†’';
                                case 1: return 'æµ…ç¡';
                                case 2: return 'æ·±ç¡';
                                default: return '';
                            }
                        }
                    },
                    grid: {
                        color: 'rgba(0, 0, 0, 0.05)'
                    }
                },
                x: {
                    grid: {
                        display: false
                    },
                    ticks: {
                        maxRotation: 0,
                        autoSkip: true,
                        maxTicksLimit: 6
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const value = context.parsed.y;
                            switch (value) {
                                case 0: return 'æ¸…é†’';
                                case 1: return 'æµ…åº¦ç¡çœ ';
                                case 2: return 'æ·±åº¦ç¡çœ ';
                                default: return '';
                            }
                        }
                    }
                }
            },
            interaction: {
                intersect: false,
                mode: 'index'
            }
        }
    });
}

// ç”Ÿæˆç¡çœ é˜¶æ®µæ•°æ®
function generateSleepStageData(sleepTime, wakeTime, quality) {
    const sleepDate = new Date(`2000-01-01T${sleepTime}`);
    const wakeDate = new Date(`2000-01-01T${wakeTime}`);
    if (wakeDate < sleepDate) {
        wakeDate.setDate(wakeDate.getDate() + 1);
    }

    const timePoints = [];
    const stages = [];
    let currentDate = new Date(sleepDate);
    let deepSleepMinutes = 0;
    let lightSleepMinutes = 0;
    let awakeMinutes = 0;

    // æ¯30åˆ†é’Ÿè®°å½•ä¸€ä¸ªæ•°æ®ç‚¹
    while (currentDate <= wakeDate) {
        timePoints.push(currentDate.toLocaleTimeString('zh-CN', {
            hour: '2-digit',
            minute: '2-digit'
        }));

        const hoursSinceSleep = (currentDate - sleepDate) / (1000 * 60 * 60);
        const hoursUntilWake = (wakeDate - currentDate) / (1000 * 60 * 60);
        let stage;

        // å…¥ç¡å’Œé†’æ¥å‰çš„æ¸…é†’æœŸ
        if (hoursSinceSleep < 0.5 || hoursUntilWake < 0.5) {
            stage = 0;
            awakeMinutes += 30;
        }
        // æ·±åº¦ç¡çœ é€šå¸¸åœ¨å…¥ç¡å2-4å°æ—¶
        else if (hoursSinceSleep > 2 && hoursSinceSleep < 4) {
            stage = Math.random() > 0.3 ? 2 : 1;
            if (stage === 2) deepSleepMinutes += 30;
            else lightSleepMinutes += 30;
        }
        // å…¶ä»–æ—¶é—´ä»¥æµ…ç¡ä¸ºä¸»
        else {
            stage = Math.random() > 0.8 ? 2 : 1;
            if (stage === 2) deepSleepMinutes += 30;
            else lightSleepMinutes += 30;
        }

        stages.push(stage);
        currentDate.setMinutes(currentDate.getMinutes() + 30);
    }

    // æ›´æ–°ç¡çœ æ—¶é•¿æ˜¾ç¤º
    document.getElementById('deepSleepTime').textContent = `${Math.round(deepSleepMinutes / 60 * 10) / 10}h`;
    document.getElementById('lightSleepTime').textContent = `${Math.round(lightSleepMinutes / 60 * 10) / 10}h`;
    document.getElementById('awakeTime').textContent = `${Math.round(awakeMinutes / 60 * 10) / 10}h`;

    return {
        labels: timePoints,
        stages: stages
    };
}

// æ›´æ–°ç¡çœ é˜¶æ®µå›¾è¡¨
function updateSleepStageChart(data) {
    if (!sleepStageChart) {
        initializeSleepStageChart();
    }

    sleepStageChart.data.labels = data.labels;
    sleepStageChart.data.datasets[0].data = data.stages;
    sleepStageChart.update();
}

// ä¿®æ”¹ä¿å­˜ç¡çœ æ•°æ®çš„å‡½æ•°
function saveSleepData(data) {
    try {
        let sleepRecords = JSON.parse(localStorage.getItem('sleepRecords') || '[]');
        sleepRecords.push({
            ...data,
            timestamp: new Date().toISOString()
        });
        localStorage.setItem('sleepRecords', JSON.stringify(sleepRecords));
        
        // ç”Ÿæˆå¹¶æ›´æ–°ç¡çœ é˜¶æ®µæ•°æ®
        const stageData = generateSleepStageData(data.sleepTime, data.wakeTime, data.quality);
        updateSleepStageChart(stageData);
        
        updateSleepDisplay();
        updateSleepSuggestions(data);
    } catch (error) {
        console.error('ä¿å­˜æ•°æ®å¤±è´¥:', error);
        showToast('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// åœ¨é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–å›¾è¡¨
document.addEventListener('DOMContentLoaded', () => {
    initializeSleepStageChart();
    
    // å¦‚æœæœ‰æœ€è¿‘çš„ç¡çœ è®°å½•ï¼Œæ˜¾ç¤ºå…¶ç¡çœ é˜¶æ®µæ•°æ®
    const records = JSON.parse(localStorage.getItem('sleepRecords') || '[]');
    if (records.length > 0) {
        const latestRecord = records[records.length - 1];
        const stageData = generateSleepStageData(latestRecord.sleepTime, latestRecord.wakeTime, latestRecord.quality);
        updateSleepStageChart(stageData);
    }
});

// è¿åŠ¨æ¨¡å—ç›¸å…³å‡½æ•°
function openExerciseModal() {
    const modal = document.getElementById('exerciseModal');
    if (modal) {
        modal.classList.remove('hidden');
    }
}

function closeExerciseModal() {
    const modal = document.getElementById('exerciseModal');
    if (modal) {
        modal.classList.add('hidden');
    }
    const form = document.getElementById('exerciseForm');
    if (form) {
        form.reset();
    }
}

function handleExerciseSubmit(event) {
    event.preventDefault();
    
    const steps = document.getElementById('stepsInput').value;
    
    if (!steps || steps <= 0) {
        showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„æ­¥æ•°');
        return;
    }
    
    const formData = {
        steps: parseInt(steps),
        types: Array.from(document.querySelectorAll('input[name="exerciseType"]:checked'))
            .map(cb => cb.value),
        date: new Date().toISOString().split('T')[0]
    };
    
    saveExerciseData(formData);
    showToast('è¿åŠ¨è®°å½•å·²ä¿å­˜');
    closeExerciseModal();
}

function saveExerciseData(data) {
    try {
        let exerciseRecords = JSON.parse(localStorage.getItem('exerciseRecords') || '[]');
        exerciseRecords.push({
            ...data,
            timestamp: new Date().toISOString()
        });
        localStorage.setItem('exerciseRecords', JSON.stringify(exerciseRecords));
        updateExerciseDisplay();
    } catch (error) {
        console.error('ä¿å­˜è¿åŠ¨æ•°æ®å¤±è´¥:', error);
        showToast('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// ç»æœŸæ¨¡å—ç›¸å…³å‡½æ•°
function openPeriodModal() {
    const modal = document.getElementById('periodModal');
    if (modal) {
        modal.classList.remove('hidden');
    }
}

function closePeriodModal() {
    const modal = document.getElementById('periodModal');
    if (modal) {
        modal.classList.add('hidden');
    }
    const form = document.getElementById('periodForm');
    if (form) {
        form.reset();
    }
    // é‡ç½®å‡ºè¡€é‡æŒ‰é’®çŠ¶æ€
    document.querySelectorAll('.flow-btn').forEach(btn => {
        btn.classList.remove('bg-pink-500', 'text-white', 'border-pink-500');
        btn.classList.add('border-gray-200');
    });
    document.getElementById('selectedFlow').value = '';
}

function selectFlow(button, value) {
    document.querySelectorAll('.flow-btn').forEach(btn => {
        btn.classList.remove('bg-pink-500', 'text-white', 'border-pink-500');
        btn.classList.add('border-gray-200');
    });
    
    button.classList.remove('border-gray-200');
    button.classList.add('bg-pink-500', 'text-white', 'border-pink-500');
    
    document.getElementById('selectedFlow').value = value;
}

function handlePeriodSubmit(event) {
    event.preventDefault();
    
    const startDate = document.getElementById('periodStartDate').value;
    const endDate = document.getElementById('periodEndDate').value;
    const flow = document.getElementById('selectedFlow').value;
    const mood = document.getElementById('selectedMood').value;
    const notes = document.getElementById('periodNotes').value;
    
    if (!startDate) {
        showToast('è¯·é€‰æ‹©å¼€å§‹æ—¥æœŸ');
        return;
    }
    
    if (!flow) {
        showToast('è¯·é€‰æ‹©å‡ºè¡€é‡');
        return;
    }
    
    const formData = {
        startDate,
        endDate,
        flow,
        mood,
        symptoms: Array.from(document.querySelectorAll('input[name="symptoms"]:checked'))
            .map(cb => cb.value),
        notes,
        date: new Date().toISOString().split('T')[0]
    };
    
    savePeriodData(formData);
    showToast('ç»æœŸè®°å½•å·²ä¿å­˜');
    closePeriodModal();
}

function savePeriodData(data) {
    try {
        let periodRecords = JSON.parse(localStorage.getItem('periodRecords') || '[]');
        periodRecords.push({
            ...data,
            timestamp: new Date().toISOString()
        });
        localStorage.setItem('periodRecords', JSON.stringify(periodRecords));
        updatePeriodDisplay();
    } catch (error) {
        console.error('ä¿å­˜ç»æœŸæ•°æ®å¤±è´¥:', error);
        showToast('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// åˆå§‹åŒ–å‡½æ•°
document.addEventListener('DOMContentLoaded', () => {
    // æ›´æ–°æ‰€æœ‰æ¨¡å—çš„æ—¥æœŸæ˜¾ç¤º
    updateCurrentDate();
    
    // åˆå§‹åŒ–å„æ¨¡å—çš„æ•°æ®æ˜¾ç¤º
    updateSleepDisplay();
    updateExerciseDisplay();
    updatePeriodDisplay();
    
    // ç»‘å®šESCé”®å…³é—­æ‰€æœ‰å¼¹çª—
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            closeSleepModal();
            closeExerciseModal();
            closePeriodModal();
        }
    });
    
    // ç»‘å®šç‚¹å‡»é®ç½©å±‚å…³é—­å¼¹çª—
    const modals = ['sleepRecordModal', 'exerciseModal', 'periodModal'];
    modals.forEach(modalId => {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    switch(modalId) {
                        case 'sleepRecordModal':
                            closeSleepModal();
                            break;
                        case 'exerciseModal':
                            closeExerciseModal();
                            break;
                        case 'periodModal':
                            closePeriodModal();
                            break;
                    }
                }
            });
        }
    });
});

let bmiTrendChart = null;

// BMIç›¸å…³å‡½æ•°
function openBmiModal() {
    const modal = document.getElementById('bmiModal');
    if (modal) {
        modal.classList.remove('hidden');
        // å¦‚æœæœ‰æœ€è¿‘çš„è®°å½•ï¼Œé¢„å¡«èº«é«˜
        const records = JSON.parse(localStorage.getItem('bmiRecords') || '[]');
        if (records.length > 0) {
            document.getElementById('heightInput').value = records[records.length - 1].height;
        }
    }
}

function closeBmiModal() {
    const modal = document.getElementById('bmiModal');
    if (modal) {
        modal.classList.add('hidden');
    }
    const form = document.getElementById('bmiForm');
    if (form) {
        form.reset();
    }
}

function calculateBMI(weight, height) {
    // å°†èº«é«˜ä»å˜ç±³è½¬æ¢ä¸ºç±³
    const heightInMeters = height / 100;
    return weight / (heightInMeters * heightInMeters);
}

function getBmiStatus(bmi) {
    if (bmi < 18.5) return { status: 'åç˜¦', color: 'text-blue-600' };
    if (bmi < 24) return { status: 'å¥åº·', color: 'text-emerald-600' };
    if (bmi < 28) return { status: 'è¶…é‡', color: 'text-yellow-600' };
    return { status: 'è‚¥èƒ–', color: 'text-red-600' };
}

function getBmiSuggestions(bmi) {
    const suggestions = [];
    
    if (bmi < 18.5) {
        suggestions.push({
            icon: 'ğŸ—',
            title: 'å¢åŠ è¥å…»æ‘„å…¥',
            content: 'å»ºè®®é€‚å½“å¢åŠ è›‹ç™½è´¨å’Œå¥åº·è„‚è‚ªçš„æ‘„å…¥ï¼Œä¿æŒå‡è¡¡é¥®é£Ÿã€‚'
        });
        suggestions.push({
            icon: 'ğŸ’ª',
            title: 'è¿›è¡ŒåŠ›é‡è®­ç»ƒ',
            content: 'å»ºè®®è¿›è¡Œé€‚åº¦çš„åŠ›é‡è®­ç»ƒï¼Œå¸®åŠ©å¢åŠ è‚Œè‚‰é‡ã€‚'
        });
    } else if (bmi >= 24 && bmi < 28) {
        suggestions.push({
            icon: 'ğŸ¥—',
            title: 'è°ƒæ•´é¥®é£Ÿç»“æ„',
            content: 'å»ºè®®å‡å°‘é«˜çƒ­é‡é£Ÿç‰©æ‘„å…¥ï¼Œå¢åŠ è”¬èœæ°´æœçš„æ¯”ä¾‹ã€‚'
        });
        suggestions.push({
            icon: 'ğŸƒ',
            title: 'å¢åŠ æœ‰æ°§è¿åŠ¨',
            content: 'å»ºè®®æ¯å‘¨è¿›è¡Œ3-4æ¬¡æœ‰æ°§è¿åŠ¨ï¼Œæ¯æ¬¡30åˆ†é’Ÿä»¥ä¸Šã€‚'
        });
    } else if (bmi >= 28) {
        suggestions.push({
            icon: 'âš–ï¸',
            title: 'æ§åˆ¶çƒ­é‡æ‘„å…¥',
            content: 'å»ºè®®ä¸¥æ ¼æ§åˆ¶æ¯æ—¥çƒ­é‡æ‘„å…¥ï¼Œé¿å…é«˜ç³–é«˜è„‚é£Ÿç‰©ã€‚'
        });
        suggestions.push({
            icon: 'ğŸ‘¨â€âš•ï¸',
            title: 'å¯»æ±‚ä¸“ä¸šå»ºè®®',
            content: 'å»ºè®®å’¨è¯¢è¥å…»å¸ˆæˆ–åŒ»ç”Ÿï¼Œåˆ¶å®šç§‘å­¦çš„å‡é‡è®¡åˆ’ã€‚'
        });
    } else {
        suggestions.push({
            icon: 'âœ¨',
            title: 'ä¿æŒç°çŠ¶',
            content: 'å½“å‰BMIå¤„äºå¥åº·èŒƒå›´ï¼Œå»ºè®®ä¿æŒè‰¯å¥½çš„é¥®é£Ÿå’Œè¿åŠ¨ä¹ æƒ¯ã€‚'
        });
    }
    
    return suggestions;
}

function handleBmiSubmit(event) {
    event.preventDefault();
    
    const weight = parseFloat(document.getElementById('weightInput').value);
    const height = parseFloat(document.getElementById('heightInput').value);
    
    if (!weight || !height) {
        showToast('è¯·å¡«å†™ä½“é‡å’Œèº«é«˜');
        return;
    }
    
    if (weight < 20 || weight > 200) {
        showToast('è¯·è¾“å…¥åˆç†çš„ä½“é‡èŒƒå›´');
        return;
    }
    
    if (height < 100 || height > 250) {
        showToast('è¯·è¾“å…¥åˆç†çš„èº«é«˜èŒƒå›´');
        return;
    }
    
    const bmi = calculateBMI(weight, height);
    const formData = {
        weight,
        height,
        bmi: Math.round(bmi * 10) / 10,
        date: new Date().toISOString().split('T')[0]
    };
    
    saveBmiData(formData);
    showToast('è®°å½•å·²ä¿å­˜');
    closeBmiModal();
}

function saveBmiData(data) {
    try {
        let bmiRecords = JSON.parse(localStorage.getItem('bmiRecords') || '[]');
        bmiRecords.push({
            ...data,
            timestamp: new Date().toISOString()
        });
        localStorage.setItem('bmiRecords', JSON.stringify(bmiRecords));
        updateBmiDisplay();
        updateBmiTrendChart();
    } catch (error) {
        console.error('ä¿å­˜BMIæ•°æ®å¤±è´¥:', error);
        showToast('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

function initializeBmiTrendChart() {
    const ctx = document.getElementById('bmiTrendChart');
    if (!ctx) return;

    if (bmiTrendChart) {
        bmiTrendChart.destroy();
    }

    bmiTrendChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'BMI',
                data: [],
                borderColor: '#10b981',
                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: false,
                    grid: {
                        color: 'rgba(0, 0, 0, 0.05)'
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

function updateBmiTrendChart() {
    if (!bmiTrendChart) {
        initializeBmiTrendChart();
    }

    const records = JSON.parse(localStorage.getItem('bmiRecords') || '[]');
    const recentRecords = records.slice(-10); // æ˜¾ç¤ºæœ€è¿‘10æ¡è®°å½•

    bmiTrendChart.data.labels = recentRecords.map(record => {
        const date = new Date(record.date);
        return `${date.getMonth() + 1}/${date.getDate()}`;
    });
    bmiTrendChart.data.datasets[0].data = recentRecords.map(record => record.bmi);
    bmiTrendChart.update();
}

function updateBmiDisplay() {
    const records = JSON.parse(localStorage.getItem('bmiRecords') || '[]');
    if (records.length === 0) return;

    const latestRecord = records[records.length - 1];
    const bmi = latestRecord.bmi;
    let statusColor, gaugeColor;

    // æ ¹æ®BMIå€¼è®¾ç½®é¢œè‰²
    if (bmi < 18.5) {
        statusColor = 'text-blue-600';
        gaugeColor = 'border-blue-500';
    } else if (bmi < 24) {
        statusColor = 'text-emerald-600';
        gaugeColor = 'border-emerald-500';
    } else if (bmi < 28) {
        statusColor = 'text-yellow-600';
        gaugeColor = 'border-yellow-500';
    } else {
        statusColor = 'text-red-600';
        gaugeColor = 'border-red-500';
    }

    // æ›´æ–°æ˜¾ç¤º
    const bmiElement = document.getElementById('currentBmi');
    const statusElement = document.getElementById('bmiStatus');
    const gaugeElement = document.getElementById('bmiGauge');

    bmiElement.textContent = bmi;
    bmiElement.className = `text-3xl font-bold ${statusColor}`;
    
    const status = getBmiStatus(bmi);
    statusElement.textContent = status.status;
    statusElement.className = `text-sm ${statusColor}`;

    // æ›´æ–°ä»ªè¡¨ç›˜é¢œè‰²å’Œè§’åº¦
    gaugeElement.className = `absolute inset-0 rounded-full border-8 ${gaugeColor} border-t-transparent`;
    const rotation = Math.min(Math.max((bmi - 15) * 10, 0), 180);
    gaugeElement.style.transform = `rotate(${rotation}deg)`;

    // æ›´æ–°å…¶ä»–æ˜¾ç¤º
    document.getElementById('currentWeight').textContent = latestRecord.weight;
    document.getElementById('currentHeight').textContent = latestRecord.height;

    // æ›´æ–°å»ºè®®
    updateBmiSuggestions(bmi);
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', () => {
    initializeBmiTrendChart();
    updateBmiDisplay();
});

// é¡µé¢åˆ‡æ¢å‡½æ•°
function switchBmiPage(pageIndex) {
    const pages = ['bmiPage0', 'bmiPage1'];
    const indicators = ['bmiPage0Indicator', 'bmiPage1Indicator'];
    
    pages.forEach((pageId, index) => {
        const page = document.getElementById(pageId);
        const indicator = document.getElementById(indicators[index]);
        if (index === pageIndex) {
            page.classList.remove('hidden');
            indicator.classList.add('bg-emerald-500');
            indicator.classList.remove('bg-emerald-200');
        } else {
            page.classList.add('hidden');
            indicator.classList.remove('bg-emerald-500');
            indicator.classList.add('bg-emerald-200');
        }
    });
}

// åˆå§‹åŒ–æ—¶æ·»åŠ è§¦æ‘¸æ»‘åŠ¨æ”¯æŒ
document.addEventListener('DOMContentLoaded', () => {
    const bmiModule = document.querySelector('.w-80.h-[600px]');
    let touchStartX = 0;
    let currentPage = 0;

    bmiModule.addEventListener('touchstart', (e) => {
        touchStartX = e.touches[0].clientX;
    });

    bmiModule.addEventListener('touchend', (e) => {
        const touchEndX = e.changedTouches[0].clientX;
        const diff = touchStartX - touchEndX;

        if (Math.abs(diff) > 50) { // æœ€å°æ»‘åŠ¨è·ç¦»
            if (diff > 0 && currentPage === 0) {
                // å‘å·¦æ»‘ï¼Œåˆ‡æ¢åˆ°ç¬¬äºŒé¡µ
                currentPage = 1;
                switchBmiPage(1);
            } else if (diff < 0 && currentPage === 1) {
                // å‘å³æ»‘ï¼Œåˆ‡æ¢åˆ°ç¬¬ä¸€é¡µ
                currentPage = 0;
                switchBmiPage(0);
            }
        }
    });
});

class SleepAnalysis {
    constructor() {
        this.container = document.querySelector('.pages-wrapper');
        this.navBtns = document.querySelectorAll('.nav-btn');
        this.currentPage = 0;

        this.initializeEvents();
        this.initializeCharts();
    }

    initializeEvents() {
        // åº•éƒ¨å¯¼èˆªæŒ‰é’®ç‚¹å‡»äº‹ä»¶
        this.navBtns.forEach((btn, index) => {
            btn.addEventListener('click', () => {
                this.goToPage(index);
                this.updateNavigation(index);
            });
        });

        // åˆå§‹åŒ–çŠ¶æ€
        this.updateNavigation(0);
    }

    goToPage(pageIndex) {
        this.currentPage = pageIndex;
        this.container.style.transform = `translateX(-${pageIndex * 100}%)`;
    }

    updateNavigation(activeIndex) {
        this.navBtns.forEach((btn, index) => {
            const icon = btn.querySelector('svg');
            const text = btn.querySelector('span');
            if (index === activeIndex) {
                icon.classList.remove('text-gray-400');
                icon.classList.add('text-indigo-600');
                text.classList.remove('text-gray-600');
                text.classList.add('text-indigo-600');
            } else {
                icon.classList.remove('text-indigo-600');
                icon.classList.add('text-gray-400');
                text.classList.remove('text-indigo-600');
                text.classList.add('text-gray-600');
            }
        });
    }

    initializeCharts() {
        // ç¡çœ é˜¶æ®µå›¾è¡¨
        const stagesCtx = document.getElementById('sleepStagesChart').getContext('2d');
        new Chart(stagesCtx, {
            type: 'line',
            data: {
                labels: ['22:00', '23:00', '00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00'],
                datasets: [{
                    label: 'æ·±åº¦ç¡çœ ',
                    data: [0, 2, 4, 3, 4, 3, 2, 1, 0],
                    borderColor: 'rgba(99, 102, 241, 1)',
                    backgroundColor: 'rgba(99, 102, 241, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 5
                    }
                }
            }
        });

        // ç¡çœ è¶‹åŠ¿å›¾è¡¨
        const trendCtx = document.getElementById('sleepTrendChart').getContext('2d');
        new Chart(trendCtx, {
            type: 'line',
            data: {
                labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                datasets: [{
                    label: 'ç¡çœ æ—¶é•¿',
                    data: [7.5, 6.8, 7.2, 8.1, 6.5, 7.8, 7.3],
                    borderColor: 'rgba(99, 102, 241, 1)',
                    backgroundColor: 'rgba(99, 102, 241, 0.1)',
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    }
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', () => {
    new SleepAnalysis();
});
</script>

<style>
/* æ·»åŠ æŒ‰é’®è¿‡æ¸¡åŠ¨ç”» */
.flow-button {
    transition: all 0.2s ease-in-out;
}

/* æ·»åŠ å¼¹çª—åŠ¨ç”» */
.modal-enter {
    animation: modalFadeIn 0.3s ease-out;
}

@keyframes modalFadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* æ·»åŠ å¿ƒæƒ…å›¾æ ‡æ ·å¼ */
.calendar-day {
    position: relative;
    width: 2.5rem;
    height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 0.5rem;
    transition: all 0.2s;
}

.calendar-day:hover {
    background-color: rgba(249, 168, 212, 0.1);
}
</style>

<!-- æ·»åŠ è¿åŠ¨å¼ºåº¦è¯´æ˜å¼¹çª— -->
<div id="intensityModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="w-full max-w-md bg-white rounded-2xl p-6 shadow-lg max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold text-gray-800">è¿åŠ¨å¼ºåº¦è¯´æ˜</h3>
            <button onclick="closeIntensityModal()" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="space-y-4">
            <p class="text-sm text-gray-600">è¿åŠ¨å¼ºåº¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p>
            <ul class="list-disc pl-5 text-sm text-gray-600 space-y-3">
                <li>
                    <div class="font-semibold text-blue-600">ä½å¼ºåº¦è¿åŠ¨</div>
                    <p class="mt-1">å¿ƒç‡èŒƒå›´ï¼šæœ€å¤§å¿ƒç‡çš„50%-60%</p>
                    <p>é€‚ç”¨æ´»åŠ¨ï¼šæ•£æ­¥ã€è½»åº¦ç‘œä¼½ã€è½»æ¾éª‘è¡Œ</p>
                    <p>èº«ä½“æ„Ÿè§‰ï¼šå¯ä»¥æ­£å¸¸äº¤è°ˆï¼Œå‘¼å¸è½»æ¾</p>
                </li>
                <li>
                    <div class="font-semibold text-blue-600">ä¸­ç­‰å¼ºåº¦è¿åŠ¨</div>
                    <p class="mt-1">å¿ƒç‡èŒƒå›´ï¼šæœ€å¤§å¿ƒç‡çš„60%-75%</p>
                    <p>é€‚ç”¨æ´»åŠ¨ï¼šå¿«èµ°ã€æ…¢è·‘ã€æ¸¸æ³³ã€éª‘è¡Œ</p>
                    <p>èº«ä½“æ„Ÿè§‰ï¼šå‘¼å¸ç¨å¿«ä½†å¹³ç¨³ï¼Œèƒ½è¿›è¡Œç®€çŸ­å¯¹è¯</p>
                </li>
                <li>
                    <div class="font-semibold text-blue-600">é«˜å¼ºåº¦è¿åŠ¨</div>
                    <p class="mt-1">å¿ƒç‡èŒƒå›´ï¼šæœ€å¤§å¿ƒç‡çš„75%-90%</p>
                    <p>é€‚ç”¨æ´»åŠ¨ï¼šè·‘æ­¥ã€HIITã€å¿«é€Ÿæ¸¸æ³³</p>
                    <p>èº«ä½“æ„Ÿè§‰ï¼šå‘¼å¸æ€¥ä¿ƒï¼Œéš¾ä»¥æŒç»­å¯¹è¯</p>
                </li>
            </ul>
            <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                <p class="text-sm text-blue-600">
                    <i class="fas fa-info-circle mr-2"></i>
                    æç¤ºï¼šæœ€å¤§å¿ƒç‡ â‰ˆ 220 - å¹´é¾„
                </p>
            </div>
            
            <!-- è¿åŠ¨å¼ºåº¦æ•ˆæœåŒºåŸŸ -->
            <div class="mt-6">
                <h4 class="text-md font-semibold text-gray-700 mb-3">ä¸åŒå¼ºåº¦è¿åŠ¨æ•ˆæœ</h4>
                <div class="space-y-3">
                    <div class="bg-white border border-blue-100 rounded-xl p-4">
                        <div class="flex items-start gap-3">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-fire-alt text-blue-500"></i>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-800">è„‚è‚ªç‡ƒçƒ§</h5>
                                <p class="text-sm text-gray-600 mt-1">ä½å¼ºåº¦å’Œä¸­ç­‰å¼ºåº¦è¿åŠ¨æ›´æœ‰åˆ©äºè„‚è‚ªç‡ƒçƒ§ã€‚æŒç»­æ—¶é—´è¾ƒé•¿çš„ä¸­ç­‰å¼ºåº¦è¿åŠ¨ï¼Œå¦‚30-60åˆ†é’Ÿçš„å¿«èµ°ï¼Œæ˜¯å‡è„‚çš„ç†æƒ³é€‰æ‹©ã€‚</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white border border-blue-100 rounded-xl p-4">
                        <div class="flex items-start gap-3">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-heartbeat text-blue-500"></i>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-800">å¿ƒè‚ºåŠŸèƒ½</h5>
                                <p class="text-sm text-gray-600 mt-1">ä¸­é«˜å¼ºåº¦çš„æœ‰æ°§è¿åŠ¨èƒ½æœ‰æ•ˆæé«˜å¿ƒè‚ºåŠŸèƒ½ã€‚é«˜å¼ºåº¦é—´æ­‡è®­ç»ƒ(HIIT)å¯ä»¥åœ¨çŸ­æ—¶é—´å†…æ˜¾è‘—æå‡å¿ƒè‚ºèƒ½åŠ›ã€‚</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white border border-blue-100 rounded-xl p-4">
                        <div class="flex items-start gap-3">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-dumbbell text-blue-500"></i>
                            </div>
                            <div>
                                <h5 class="font-medium text-gray-800">è‚Œè‚‰å¼ºåŒ–</h5>
                                <p class="text-sm text-gray-600 mt-1">é«˜å¼ºåº¦åŠ›é‡è®­ç»ƒå¯¹è‚Œè‚‰ç”Ÿé•¿å’ŒåŠ›é‡æå‡æœ€ä¸ºæœ‰æ•ˆã€‚ä¸­ç­‰å¼ºåº¦çš„åŠ›é‡è®­ç»ƒåˆ™é€‚åˆè‚Œè‚‰è€åŠ›çš„æé«˜ã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- æ·»åŠ ç¡çœ è¯¦ç»†æŠ¥å‘Šå¼¹çª— -->
<div id="sleepDetailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="w-full max-w-2xl bg-white rounded-2xl p-6 shadow-lg max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold text-gray-800">ç¡çœ è¯¦ç»†æŠ¥å‘Š</h3>
            <button onclick="closeSleepDetailModal()" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <!-- ç¡çœ è´¨é‡æ¦‚è§ˆ -->
        <div class="grid grid-cols-3 gap-4 mb-6">
            <div class="bg-indigo-50 rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-indigo-600">85</div>
                <div class="text-sm text-gray-600">ç¡çœ è¯„åˆ†</div>
            </div>
            <div class="bg-indigo-50 rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-indigo-600">7h 30m</div>
                <div class="text-sm text-gray-600">æ€»ç¡çœ æ—¶é•¿</div>
            </div>
            <div class="bg-indigo-50 rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-indigo-600">92%</div>
                <div class="text-sm text-gray-600">ç¡çœ æ•ˆç‡</div>
            </div>
        </div>

        <!-- ç¡çœ é˜¶æ®µè¯¦æƒ… -->
        <div class="mb-6">
            <h4 class="text-lg font-semibold text-gray-800 mb-4">ç¡çœ é˜¶æ®µåˆ†æ</h4>
            <div class="space-y-3">
                <div class="flex items-center">
                    <div class="w-24 text-sm text-gray-600">æ·±åº¦ç¡çœ </div>
                    <div class="flex-1 h-4 bg-gray-100 rounded-full overflow-hidden">
                        <div class="h-full bg-indigo-600 rounded-full" style="width: 35%"></div>
                    </div>
                    <div class="w-20 text-right text-sm text-indigo-600">2h 15m</div>
                </div>
                <div class="flex items-center">
                    <div class="w-24 text-sm text-gray-600">æµ…åº¦ç¡çœ </div>
                    <div class="flex-1 h-4 bg-gray-100 rounded-full overflow-hidden">
                        <div class="h-full bg-indigo-400 rounded-full" style="width: 55%"></div>
                    </div>
                    <div class="w-20 text-right text-sm text-indigo-600">4h 15m</div>
                </div>
                <div class="flex items-center">
                    <div class="w-24 text-sm text-gray-600">æ¸…é†’</div>
                    <div class="flex-1 h-4 bg-gray-100 rounded-full overflow-hidden">
                        <div class="h-full bg-gray-400 rounded-full" style="width: 10%"></div>
                    </div>
                    <div class="w-20 text-right text-sm text-indigo-600">1h</div>
                </div>
            </div>
        </div>

        <!-- ç¡çœ ç¯å¢ƒåˆ†æ -->
        <div class="mb-6">
            <h4 class="text-lg font-semibold text-gray-800 mb-4">ç¡çœ ç¯å¢ƒ</h4>
            <div class="grid grid-cols-3 gap-4">
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-temperature-low text-indigo-500"></i>
                        <div>
                            <div class="text-sm text-gray-600">å®¤æ¸©</div>
                            <div class="text-lg font-semibold">22.5Â°C</div>
                        </div>
                    </div>
                </div>
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-volume-down text-indigo-500"></i>
                        <div>
                            <div class="text-sm text-gray-600">å™ªéŸ³</div>
                            <div class="text-lg font-semibold">32dB</div>
                        </div>
                    </div>
                </div>
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-lightbulb text-indigo-500"></i>
                        <div>
                            <div class="text-sm text-gray-600">å…‰ç…§</div>
                            <div class="text-lg font-semibold">å¾®å¼±</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¡çœ å‘¨æœŸå›¾è¡¨ -->
        <div class="mb-6">
            <h4 class="text-lg font-semibold text-gray-800 mb-4">ç¡çœ å‘¨æœŸ</h4>
            <div class="h-32 bg-indigo-50 rounded-xl p-4 flex items-end">
                <!-- ç¡çœ å‘¨æœŸæ³¢å½¢å›¾ -->
                <div class="w-full h-full flex items-end">
                    <div class="flex-1 flex items-end">
                        <!-- æ¨¡æ‹Ÿç¡çœ å‘¨æœŸæ³¢å½¢ -->
                        <div class="w-1/6 bg-indigo-200" style="height: 20%"></div>
                        <div class="w-1/6 bg-indigo-300" style="height: 40%"></div>
                        <div class="w-1/6 bg-indigo-500" style="height: 80%"></div>
                        <div class="w-1/6 bg-indigo-600" style="height: 95%"></div>
                        <div class="w-1/6 bg-indigo-400" style="height: 60%"></div>
                        <div class="w-1/6 bg-indigo-300" style="height: 40%"></div>
                        <div class="w-1/6 bg-indigo-200" style="height: 30%"></div>
                        <div class="w-1/6 bg-indigo-400" style="height: 70%"></div>
                        <div class="w-1/6 bg-indigo-500" style="height: 85%"></div>
                        <div class="w-1/6 bg-indigo-600" style="height: 90%"></div>
                        <div class="w-1/6 bg-indigo-400" style="height: 60%"></div>
                        <div class="w-1/6 bg-indigo-300" style="height: 45%"></div>
                    </div>
                </div>
            </div>
            <div class="flex justify-between text-xs text-gray-500 mt-2">
                <span>23:30</span>
                <span>01:30</span>
                <span>03:30</span>
                <span>05:30</span>
                <span>07:00</span>
            </div>
        </div>

        <!-- ç¡çœ è´¨é‡æŒ‡æ ‡ -->
        <div class="mb-6">
            <h4 class="text-lg font-semibold text-gray-800 mb-4">ç¡çœ è´¨é‡æŒ‡æ ‡</h4>
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-gray-600">å¤œé—´é†’æ¥æ¬¡æ•°</div>
                            <div class="text-xl font-semibold text-indigo-600 mt-1">2æ¬¡</div>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-indigo-50 flex items-center justify-center">
                            <i class="fas fa-bed text-indigo-500"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-gray-600">å…¥ç¡æ—¶é—´</div>
                            <div class="text-xl font-semibold text-indigo-600 mt-1">18åˆ†é’Ÿ</div>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-indigo-50 flex items-center justify-center">
                            <i class="fas fa-hourglass-half text-indigo-500"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-gray-600">å¹³å‡å¿ƒç‡</div>
                            <div class="text-xl font-semibold text-indigo-600 mt-1">58 bpm</div>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-indigo-50 flex items-center justify-center">
                            <i class="fas fa-heartbeat text-indigo-500"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-gray-600">å‘¼å¸é¢‘ç‡</div>
                            <div class="text-xl font-semibold text-indigo-600 mt-1">14 æ¬¡/åˆ†</div>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-indigo-50 flex items-center justify-center">
                            <i class="fas fa-wind text-indigo-500"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ”¹å–„å»ºè®® -->
        <div>
            <h4 class="text-lg font-semibold text-gray-800 mb-4">æ”¹å–„å»ºè®®</h4>
            <div class="bg-indigo-50 rounded-xl p-4 space-y-3">
                <div class="flex items-start gap-3">
                    <i class="fas fa-check-circle text-indigo-500 mt-1"></i>
                    <p class="text-sm text-gray-600">å»ºè®®ä¿æŒå›ºå®šçš„ä½œæ¯æ—¶é—´ï¼Œé¿å…æ˜¼å¤œé¢ å€’</p>
                </div>
                <div class="flex items-start gap-3">
                    <i class="fas fa-check-circle text-indigo-500 mt-1"></i>
                    <p class="text-sm text-gray-600">ç¡å‰1å°æ—¶é¿å…ä½¿ç”¨ç”µå­è®¾å¤‡ï¼Œå‡å°‘è“å…‰ç…§å°„</p>
                </div>
                <div class="flex items-start gap-3">
                    <i class="fas fa-check-circle text-indigo-500 mt-1"></i>
                    <p class="text-sm text-gray-600">ä¿æŒé€‚å®œçš„å®¤æ¸©ï¼ˆ18-22Â°Cï¼‰å’Œå®‰é™çš„ç¡çœ ç¯å¢ƒ</p>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
